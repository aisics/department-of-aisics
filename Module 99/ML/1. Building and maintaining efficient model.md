**Лекція 99.1: Процес розробки моделі машинного навчання**

**Мета лекції:** Надати слухачам структуроване розуміння повного життєвого циклу створення моделі машинного навчання – від початкової ідеї до впровадження та підтримки. Розглянути ключові етапи, їхню важливість та взаємозв'язок.

---

Доброго дня! На попередніх лекціях ми познайомилися з різними алгоритмами машинного навчання – лінійними моделями, деревами рішень, нейронними мережами. Ми бачили, *як* вони працюють теоретично. Але як перейти від теорії до створення реальної, працюючої моделі, яка вирішує конкретну задачу?

Побудова моделі машинного навчання – це не просто вибір алгоритму та натискання кнопки "Train". Це цілий **інженерний процес**, який вимагає системного підходу, розуміння даних, експериментів та постійної оцінки. Незалежно від того, чи працюєте ви над проектом для львівської IT-компанії, чи для власного стартапу, сьогодні, 17 квітня 2025 року, розуміння цього процесу є ключовим для успішного застосування штучного інтелекту.

Сьогодні ми розглянемо типовий **життєвий цикл розробки моделі машинного навчання**, крок за кроком:

1.  **Розуміння задачі та постановка мети**
2.  **Збір даних**
3.  **Підготовка та попередня обробка даних** (Дуже важливий етап!)
4.  **Вибір моделі**
5.  **Навчання моделі**
6.  **Оцінка моделі**
7.  **Налаштування та покращення моделі**
8.  **Розгортання моделі**
9.  **Моніторинг та підтримка**

Давайте пройдемося по кожному з цих етапів.

---

**1. Розуміння задачі та постановка мети**

Перш ніж писати будь-який код чи аналізувати дані, потрібно чітко зрозуміти:

* **Яку проблему ми вирішуємо?** Це має бути конкретна, вимірювана проблема. Не просто "покращити бізнес", а, наприклад, "зменшити відтік клієнтів на 10%", "підвищити точність медичної діагностики для певного захворювання", "оптимізувати логістичні маршрути", "персоналізувати рекомендації товарів".
* **Якого результату ми хочемо досягти?** Це виливається у визначення типу задачі ML:
    * Це **класифікація** (передбачити категорію: спам/не спам, хворий/здоровий)?
    * Чи **регресія** (передбачити числове значення: ціна, температура, кількість продажів)?
    * Чи **кластеризація** (згрупувати схожі об'єкти)?
    * Чи щось інше (детекція об'єктів, генерація тексту)?
* **Як ми будемо вимірювати успіх?** Потрібно визначити **метрики**:
    * **Бізнес-метрики:** Як модель вплине на ключові показники бізнесу (прибуток, задоволеність клієнтів, ефективність процесів)?
    * **Технічні метрики:** Які показники якості моделі ми будемо використовувати (точність, повнота, F1-оцінка для класифікації; MSE, MAE для регресії)? Вибір метрики залежить від задачі та бізнес-цілей.

Чітке розуміння мети на цьому етапі визначає весь подальший напрямок роботи.

---

**2. Збір даних (Data Collection)**

Моделі машинного навчання навчаються на даних. Без даних немає навчання.

* **Джерела:** Дані можуть надходити з різних джерел: внутрішні бази даних компанії, файли журналів (логи) веб-сайтів чи додатків, дані з датчиків (IoT), відкриті публічні датасети (напр., Kaggle Datasets, Google Dataset Search), дані з API інших сервісів, результати опитувань, або дані, зібрані вручну.
* **Релевантність:** Чи дійсно зібрані дані містять інформацію, необхідну для вирішення поставленої задачі? Чи відображають вони ті фактори, які впливають на результат, що нас цікавить?
* **Достатність:** Чи вистачить зібраних даних для навчання моделі? Особливо глибокі нейронні мережі потребують великих обсягів даних.
* **Якість та надійність:** Наскільки дані точні, повні та послідовні?
* **Етичні та правові аспекти:** Чи маємо ми право збирати та використовувати ці дані? Чи дотримуємося ми вимог щодо захисту персональних даних (як GDPR)?

Збір правильних даних – фундаментальний крок.

---

**3. Підготовка та попередня обробка даних (Data Preprocessing)**

Це, мабуть, **найбільш трудомісткий**, але й **один із найважливіших етапів** у всьому процесі. Сирі дані майже ніколи не готові до безпосереднього використання моделями. Принцип "Garbage In, Garbage Out" (Сміття на вході – сміття на виході) тут дуже доречний.

* **Очищення даних (Data Cleaning):**
    * **Обробка пропущених значень:** Дані часто бувають неповними. Потрібно вирішити, що робити з пропусками: видаляти рядки/стовпці (обережно, можна втратити інформацію), чи заповнювати (імпутувати) пропуски (напр., середнім, медіаною, модою, або більш складними методами). *Приклад:* Якщо у даних про клієнтів пропущений вік, можна замінити його середнім віком всіх клієнтів.
    * **Обробка викидів (Outliers):** Виявлення та обробка екстремальних значень, що сильно відрізняються від решти даних. Вони можуть бути помилками введення або справжніми аномаліями. Залежно від причини, їх можна видалити, скоригувати або використати моделі, стійкі до викидів. *Приклад:* Ціна будинку, що в 100 разів вища за інші в тому ж районі.
* **Трансформація даних (Data Transformation):**
    * **Масштабування ознак (Feature Scaling):** Приведення числових ознак до спільного діапазону. Дуже важливо для алгоритмів, чутливих до відстаней (KNN, SVM) або тих, що використовують градієнтний спуск (нейронні мережі). Популярні методи: стандартизація (середнє 0, ст. відхилення 1), нормалізація (діапазон [0, 1]). *Приклад:* Масштабувати ознаку "вік" (0-100) та "річний дохід" (десятки-сотні тисяч) до одного порядку.
    * **Кодування категоріальних змінних:** Перетворення текстових категорій на числа. Основні методи: One-Hot Encoding (створення бінарних колонок для кожної категорії), Label Encoding (присвоєння унікального числа кожній категорії). *Приклад:* Перетворити колонку "Місто" з назвами "Львів", "Київ", "Одеса" на числові представлення.
    * *(Сюди ж відноситься Інженерія Ознак, яку ми розглядали окремо – створення нових, більш інформативних ознак)*.
* **Розділення даних (Data Splitting):**
    * **Навіщо:** Щоб об'єктивно оцінити, наскільки добре модель буде працювати на **нових, не бачених раніше даних**, і щоб уникнути перенавчання під час налаштування моделі.
    * **Як:** Весь набір даних розділяється щонайменше на три частини:
        1.  **Навчальна вибірка (Training Set):** Найбільша частина (~60-80%). Використовується для безпосереднього "тренування" моделі – налаштування її внутрішніх параметрів (ваг).
        2.  **Валідаційна вибірка (Validation Set / Dev Set):** Менша частина (~10-20%). **Не використовується** для навчання параметрів моделі. Використовується для **налаштування гіперпараметрів** алгоритму (напр., швидкості навчання, k у KNN, параметрів регуляризації) та для **вибору найкращої моделі** з кількох кандидатів.
        3.  **Тестова вибірка (Test Set):** Менша частина (~10-20%). **Відкладається і не використовується** ні для навчання, ні для валідації/налаштування. Використовується **лише один раз** наприкінці, щоб отримати фінальну, **неупереджену оцінку** якості обраної та налаштованої моделі.

---

**4. Вибір моделі (Model Selection)**

На основі розуміння задачі (крок 1) та підготовлених даних (крок 3) потрібно вибрати один або декілька алгоритмів машинного навчання для експериментів.

* **Критерії вибору:**
    * Тип задачі (регресія, класифікація, кластеризація).
    * Розмір та характеристики даних (кількість прикладів, кількість ознак, лінійність/нелінійність залежностей).
    * Вимоги до інтерпретованості моделі (чи потрібно розуміти, *чому* модель приймає рішення?).
    * Наявні обчислювальні ресурси.
    * Часові обмеження на розробку та прогнозування.
* **Порада:** **Починайте з простіших моделей!** Лінійна/логістична регресія, дерева рішень – це хороші базові моделі (baselines), з якими можна порівнювати результати більш складних алгоритмів. Не варто одразу братися за глибокі нейронні мережі для кожної задачі.

---

**5. Навчання моделі (Model Training)**

Це процес, під час якого обраний алгоритм "вивчає" закономірності з **навчальної вибірки**.

* **Як відбувається:** Алгоритм ітеративно налаштовує свої **внутрішні параметри** (наприклад, ваги $\theta$ у лінійних моделях та нейромережах; точки та критерії розбиття у деревах рішень) таким чином, щоб **мінімізувати функцію втрат**, яка вимірює помилку між прогнозами моделі та реальними значеннями на навчальній вибірці.
* **Механізми:** Ми вже знаємо основний механізм для багатьох моделей – **градієнтний спуск** та його варіанти (для нейромереж – з використанням **зворотного поширення помилки**).

---

**6. Оцінка моделі (Model Evaluation)**

Після навчання потрібно зрозуміти, наскільки добре модель працює **на даних, яких вона не бачила під час навчання**.

* **Навіщо:** Перевірити здатність моделі до **генералізації** (узагальнення). Висока точність на навчальній вибірці ще нічого не гарантує!
* **Як:** Використовуємо **валідаційну вибірку** (або результати **крос-валідації** на навчальній вибірці) та розраховуємо заздалегідь обрані **технічні метрики** (MSE, MAE для регресії; Accuracy, Precision, Recall, F1-score, AUC для класифікації).
* **Аналіз результатів:** Якщо метрики низькі, потрібно повертатися до попередніх кроків: можливо, потрібна краща обробка даних, інша модель, або більше даних.

---

**7. Налаштування гіперпараметрів та покращення моделі (Hyperparameter Tuning & Improvement)**

Майже кожен алгоритм ML має **гіперпараметри** – налаштування, які не вивчаються з даних, а задаються до початку навчання (напр., швидкість навчання $\alpha$, параметр регуляризації $\lambda$, кількість сусідів $k$ у KNN, глибина дерева, кількість шарів/нейронів у мережі).

* **Мета:** Знайти таку комбінацію гіперпараметрів, яка дає **найкращу якість** моделі на **валідаційній вибірці** (або за результатами крос-валідації).
* **Методи:** Ручний підбір, **Пошук по сітці (Grid Search)**, **Випадковий пошук (Random Search)**, Баєсівська оптимізація.
* **Ітеративність:** Цей крок часто є циклом: спробували набір гіперпараметрів -> навчили модель (крок 5) -> оцінили на валідації (крок 6) -> змінили гіперпараметри -> повторили. Також на цьому етапі можемо спробувати зовсім іншу архітектуру моделі.

---

**8. Розгортання моделі (Deployment)**

Після того, як ми вибрали найкращу модель та налаштували її гіперпараметри, і задоволені її очікуваною якістю (перевіреною на тестовій вибірці!), модель готова до використання в реальному світі.

* **Що це:** Впровадження навченої моделі у робоче середовище, де вона зможе приймати нові дані та робити прогнози.
* **Форми:** Це може бути REST API сервіс, інтеграція в існуючу програму, модель, що працює на мобільному пристрої ("edge AI") тощо.
* **Виклики:** Вимагає навичок не лише в ML, а й у програмній інженерії, DevOps (MLOps), знання інфраструктури. Потрібно забезпечити швидкість роботи, надійність, масштабованість.

---

**9. Моніторинг та підтримка (Monitoring & Maintenance)**

Робота над моделлю не закінчується після розгортання.

* **Навіщо:** Реальний світ постійно змінюється, і дані, на яких навчалася модель, з часом можуть стати неактуальними (**зсув даних / data drift**). Якість моделі в продакшені може погіршуватися.
* **Що робити:**
    * **Відстежувати** якість прогнозів моделі в реальному часі.
    * **Моніторити** характеристики вхідних даних (чи не змінилися вони?).
    * **Періодично перенавчати** модель на свіжих даних.
    * Збирати зворотний зв'язок для подальшого покращення.

Це безперервний цикл підтримки та оновлення моделі.

---

**Висновок**

Процес розробки моделі машинного навчання – це не лінійний шлях, а **ітеративний цикл**. Ми постійно повертаємось до попередніх етапів, аналізуємо результати, експериментуємо з даними, ознаками, моделями та гіперпараметрами. Ключовими для успіху є не лише знання алгоритмів, але й ретельна робота з даними, правильна оцінка якості та системний підхід до всього процесу.

Розуміння цього життєвого циклу допоможе вам структурувати роботу над будь-яким проектом у сфері штучного інтелекту та машинного навчання.

**Наступні кроки**

* Подумайте, який етап цього процесу здається вам найскладнішим або найцікавішим?
* Які інструменти (програмні бібліотеки) можуть допомогти на кожному з цих етапів? (Ми це не обговорювали детально, але це важливе питання для практики).
* Ми завершили огляд ключових концепцій та процесів у машинному навчанні. Тепер ви маєте хорошу базу для подальшого, більш глибокого вивчення конкретних алгоритмів, інструментів та застосувань ШІ.

---

Дякую за увагу! Я готовий відповісти на ваші запитання.