## Нормалізація Векторів: Приклад для Порівняння Товарів

Коли ми використовуємо алгоритми, що базуються на вимірюванні відстаней виникає проблема: ознаки з великими значеннями можуть непропорційно сильно впливати на результат, нівелюючи внесок ознак з меншими значеннями. Це відбувається через масштаб чисел, а не через реальну важливість ознаки.

**Нормалізація векторів** — це процес перетворення даних, який приводить усі ознаки до спільного, порівнянного масштабу, не змінюючи при цьому відносної інформації всередині кожної ознаки. Це допомагає уникнути проблеми домінування масштабу.

Розглянемо конкретний приклад.

### Дані для Прикладу

Уявімо, що ми хочемо порівняти три товари (А, Б, В) за двома ознаками:
1.  **Ціна** (в гривнях)
2.  **Рейтинг** (від 1 до 10)

Наші товари:
* **Товар А:** Ціна = 10 000 грн, Рейтинг = 8
* **Товар Б:** Ціна = 10 500 грн, Рейтинг = 2
* **Товар В:** Ціна = 9 000 грн, Рейтинг = 7

Представимо їх у вигляді векторів ознак:
* Вектор A: $[10000, 8]$
* Вектор Б: $[10500, 2]$
* Вектор В: $[9000, 7]$

### Проблема: Розрахунок відстаней без нормалізації

Щоб оцінити, наскільки товари схожі чи відмінні один від одного, ми можемо обчислити Евклідову відстань між їхніми векторами. Формула Евклідової відстані між двома точками $(x_1, y_1)$ та $(x_2, y_2)$ у двовимірному просторі: $d = \sqrt{(x_2 - x_1)^2 + (y_2 - y_1)^2}$.

Обчислимо відстані між усіма парами товарів:

1.  **Відстань між А і Б (d(A, B)):**
    $d(A, B) = \sqrt{(10500 - 10000)^2 + (2 - 8)^2}$
    $d(A, B) = \sqrt{500^2 + (-6)^2}$
    $d(A, B) = \sqrt{250000 + 36}$
    $d(A, B) = \sqrt{250036} \approx 500.04$
    *(Аналіз: Внесок ціни ($500^2 = 250000$) значно переважає внесок рейтингу ($(-6)^2 = 36$))*

2.  **Відстань між А і В (d(A, C)):**
    $d(A, C) = \sqrt{(9000 - 10000)^2 + (7 - 8)^2}$
    $d(A, C) = \sqrt{(-1000)^2 + (-1)^2}$
    $d(A, C) = \sqrt{1000000 + 1}$
    $d(A, C) = \sqrt{1000001} \approx 1000.00$
    *(Аналіз: Внесок ціни ($(-1000)^2 = 1000000$) майже повністю визначає відстань порівняно з внеском рейтингу ($(-1)^2 = 1$))*

3.  **Відстань між Б і В (d(B, C)):**
    $d(B, C) = \sqrt{(9000 - 10500)^2 + (7 - 2)^2}$
    $d(B, C) = \sqrt{(-1500)^2 + 5^2}$
    $d(B, C) = \sqrt{2250000 + 25}$
    $d(B, C) = \sqrt{2250025} \approx 1500.01$
    *(Аналіз: Внесок ціни ($(-1500)^2 = 2250000$) абсолютно домінує над внеском рейтингу ($5^2 = 25$))*

**Спостереження без нормалізації:**
Відстані майже повністю визначаються різницею в цінах:
* d(A, B) ≈ 500.04
* d(A, C) ≈ 1000.00
* d(B, C) ≈ 1500.01

Виходячи з цих розрахунків, найближчими є товари А і Б, а найвіддаленішими – Б і В. Вплив рейтингу, навіть значної різниці (як між А і Б), практично нівелюється через значно більший масштаб цін.

### Рішення: Нормалізація за допомогою Min-Max Scaling

Застосуємо один із найпоширеніших методів нормалізації – **Min-Max Scaling**. Він масштабує значення кожної ознаки таким чином, щоб вони потрапляли у визначений діапазон, зазвичай $[0, 1]$.
Формула:
$X_{norm} = \frac{X - X_{min}}{X_{max} - X_{min}}$
де $X$ – поточне значення ознаки, $X_{min}$ – мінімальне значення цієї ознаки у всьому наборі даних, $X_{max}$ – максимальне значення.

Для нашого прикладу припустимо, що ми проаналізували більший набір даних і визначили такі мінімуми та максимуми:
* Для ціни: $X_{min} = 1000$ грн, $X_{max} = 15000$ грн. Діапазон ($X_{max} - X_{min}$) = 14000 грн.
* Для рейтингу: $X_{min} = 1$, $X_{max} = 10$. Діапазон ($X_{max} - X_{min}$) = 9.

Тепер нормалізуємо вектори A, Б і В:

* **Нормалізація вектора А ($[10000, 8]$):**
    * Норм. ціна А: $\frac{10000 - 1000}{14000} = \frac{9000}{14000} \approx 0.643$
    * Норм. рейтинг А: $\frac{8 - 1}{9} = \frac{7}{9} \approx 0.778$
    * **Нормалізований Вектор А': $[0.643, 0.778]$**

* **Нормалізація вектора Б ($[10500, 2]$):**
    * Норм. ціна Б: $\frac{10500 - 1000}{14000} = \frac{9500}{14000} \approx 0.679$
    * Норм. рейтинг Б: $\frac{2 - 1}{9} = \frac{1}{9} \approx 0.111$
    * **Нормалізований Вектор Б': $[0.679, 0.111]$**

* **Нормалізація вектора В ($[9000, 7]$):**
    * Норм. ціна В: $\frac{9000 - 1000}{14000} = \frac{8000}{14000} \approx 0.571$
    * Норм. рейтинг В: $\frac{7 - 1}{9} = \frac{6}{9} \approx 0.667$
    * **Нормалізований Вектор В': $[0.571, 0.667]$**

### Розрахунок відстаней з нормалізованими даними

Тепер, коли всі ознаки знаходяться в одному масштабі $[0, 1]$, обчислимо Евклідову відстань між нормалізованими векторами А', Б' і В'.

1.  **Відстань між А' і Б' (d(A', B')):**
    $d(A', B') = \sqrt{(0.679 - 0.643)^2 + (0.111 - 0.778)^2}$
    $d(A', B') = \sqrt{0.036^2 + (-0.667)^2}$
    $d(A', B') \approx \sqrt{0.0013 + 0.4449}$
    $d(A', B') = \sqrt{0.4462} \approx 0.668$
    *(Аналіз: Тепер внесок рейтингу ($(-0.667)^2 \approx 0.4449$) значно більший за внесок ціни ($0.036^2 \approx 0.0013$))*

2.  **Відстань між А' і В' (d(A', C')):**
    $d(A', C') = \sqrt{(0.571 - 0.643)^2 + (0.667 - 0.778)^2}$
    $d(A', C') = \sqrt{(-0.072)^2 + (-0.111)^2}$
    $d(A', C') \approx \sqrt{0.0052 + 0.0123}$
    $d(A', C') = \sqrt{0.0175} \approx 0.132$
    *(Аналіз: Внески ціни ($(-0.072)^2 \approx 0.0052$) та рейтингу ($(-0.111)^2 \approx 0.0123$) тепер порівнянні, рейтинг має трохи більший вплив.)*

3.  **Відстань між Б' і В' (d(B', C')):**
    $d(B', C') = \sqrt{(0.571 - 0.679)^2 + (0.667 - 0.111)^2}$
    $d(B', C') = \sqrt{(-0.108)^2 + (0.556)^2}$
    $d(B', C') \approx \sqrt{0.0117 + 0.3091}$
    $d(B', C') = \sqrt{0.3208} \approx 0.566$
    *(Аналіз: Внесок рейтингу ($0.556^2 \approx 0.3091$) значно переважає внесок ціни ($(-0.108)^2 \approx 0.0117$))*

### Порівняння результатів та висновок

Давайте порівняємо відстані до і після нормалізації:

| Пара товарів | Відстань БЕЗ нормалізації | Відстань ПІСЛЯ нормалізації (Min-Max) | Найближчі? (Після) |
| :----------- | :------------------------ | :------------------------------------ | :------------------ |
| А і Б        | ≈ 500.04                  | ≈ 0.668                               | Ні                  |
| А і В        | ≈ 1000.00                 | ≈ 0.132                               | **Так** |
| Б і В        | ≈ 1500.01                 | ≈ 0.566                               | Ні                  |

Як бачимо, результати кардинально змінилися:

* **Без нормалізації:** Відстані майже повністю визначалися ціною. Найближчими були А і Б (мала різниця в ціні), найдальшими Б і В (велика різниця в ціні).
* **Після нормалізації:** Відстані враховують відносні зміни в обох ознаках. Найближчими стали **А і В** (мала різниця в нормалізованих цінах і рейтингах). Найвіддаленішими стали **А і Б** (мала різниця в нормалізованій ціні, але дуже велика різниця в нормалізованому рейтингу).

**Висновок:** Нормалізація даних є критично важливим кроком попередньої обробки для багатьох алгоритмів машинного навчання. Вона дозволяє уникнути ситуації, коли ознаки з великими значеннями домінують над ознаками з малими значеннями виключно через їх масштаб. Завдяки нормалізації, кожна ознака робить справедливий внесок у результат, що призводить до більш точних і змістовних висновків та кращої роботи моделей.